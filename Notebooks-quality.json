{"paragraphs":[{"title":"Calculate Estimator For Test-Set","text":"%spark\n\nval host = z.input(\"Host\", \"whyaron\")\nval diyPort = z.input(\"DIY Port\", \"9000\")\nval esPort = z.input(\"ES Port\", \"9200\")\n\nval project1 = z.input(\"Project - 1\")\nval topic1 = z.input(\"Topic - 1\")\nval testset1 = z.input(\"Test set - 1\")\n\nval project2 = z.input(\"Project - 2\")\nval topic2 = z.input(\"Topic - 2\")\nval testset2 = z.input(\"Test set - 2\")\n\n\nval server = host + \":\" + diyPort\nval elastic = host + \":\" + esPort\n\n\nval data = List(ConfData(project1.toString, topic1.toString, testset1.toString), ConfData(project2.toString, topic2.toString, testset2.toString))\n// calculate the estimator values\ncalcEstimatorForConf(data)\n","dateUpdated":"2016-12-22T18:13:56+0200","config":{"colWidth":6,"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"threshold","index":0,"aggr":"sum"}],"values":[{"name":"recall1","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"threshold","index":0,"aggr":"sum"},"yAxis":{"name":"recall1","index":1,"aggr":"sum"}}}}],"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"threshold","index":0,"aggr":"sum"}],"values":[{"name":"count1","index":2,"aggr":"avg"},{"name":"count2","index":4,"aggr":"avg"}],"groups":[],"scatter":{"xAxis":{"name":"threshold","index":0,"aggr":"sum"},"yAxis":{"name":"count1","index":2,"aggr":"sum"}}}},"settings":{"params":{"name":"sss","project":"","Project":"ndmvp","Test set":"BKRT","Server":"whyaron:9000","Elastic":"whyaron:9200","Topic":"BKRT","Host":"whyaron","DIY Port":"9000","ES Port":"9200","Project - 1":"6_topics_nd_1","Topic - 1":"CHAIR1","Test set - 1":"CHAIR1_10K","Project - 2":"6_topics_nd_2","Topic - 2":"CHAIR1","Test set - 2":"CHAIR1_10K"},"forms":{"Host":{"name":"Host","displayName":"Host","type":"input","defaultValue":"whyaron","hidden":false},"DIY Port":{"name":"DIY Port","displayName":"DIY Port","type":"input","defaultValue":"9000","hidden":false},"ES Port":{"name":"ES Port","displayName":"ES Port","type":"input","defaultValue":"9200","hidden":false},"Project - 1":{"name":"Project - 1","displayName":"Project - 1","type":"input","defaultValue":"","hidden":false},"Topic - 1":{"name":"Topic - 1","displayName":"Topic - 1","type":"input","defaultValue":"","hidden":false},"Test set - 1":{"name":"Test set - 1","displayName":"Test set - 1","type":"input","defaultValue":"","hidden":false},"Project - 2":{"name":"Project - 2","displayName":"Project - 2","type":"input","defaultValue":"","hidden":false},"Topic - 2":{"name":"Topic - 2","displayName":"Topic - 2","type":"input","defaultValue":"","hidden":false},"Test set - 2":{"name":"Test set - 2","displayName":"Test set - 2","type":"input","defaultValue":"","hidden":false}}},"jobName":"paragraph_1481838235659_1446812329","id":"20161215-234355_619499908","result":{"code":"ERROR","type":"TEXT","msg":"\nhost: Object = whyaron\n\ndiyPort: Object = 9000\n\nesPort: Object = 9200\n\nproject1: Object = 6_topics_nd_1\n\ntopic1: Object = CHAIR1\n\ntestset1: Object = CHAIR1_10K\n\nproject2: Object = 6_topics_nd_2\n\ntopic2: Object = CHAIR1\n\ntestset2: Object = CHAIR1_10K\n\nserver: String = whyaron:9000\n\nelastic: String = whyaron:9200\n\ndata: List[ConfData] = List(ConfData(6_topics_nd_1,CHAIR1,CHAIR1_10K), ConfData(6_topics_nd_2,CHAIR1,CHAIR1_10K))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njava.lang.OutOfMemoryError: Java heap space\n  at java.util.Arrays.copyOf(Arrays.java:3332)\n  at java.lang.AbstractStringBuilder.ensureCapacityInternal(AbstractStringBuilder.java:124)\n  at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:596)\n  at java.lang.StringBuilder.append(StringBuilder.java:190)\n  at scala.collection.mutable.StringBuilder.appendAll(StringBuilder.scala:249)\n  at scala.io.BufferedSource.mkString(BufferedSource.scala:97)\n  at $$$$47a5b8f2b16b1e858650dde15ad368$$$getAllDocs(<console>:415)\n  at $$$$47a5b8f2b16b1e858650dde15ad368$$$getUnlabledPassedThrehold(<console>:419)\n  at $$$$954b394d917043cf4cbe6d89a06415$$$$anonfun$calcEstimatorForConf$1.apply(<console>:443)\n  at $$$$954b394d917043cf4cbe6d89a06415$$$$anonfun$calcEstimatorForConf$1.apply(<console>:435)\n  at scala.collection.immutable.List.foreach(List.scala:381)\n  at $$$$47a5b8f2b16b1e858650dde15ad368$$$calcEstimatorForConf(<console>:435)\n  ... 20 elided\n"},"dateCreated":"2016-12-15T11:43:55+0200","dateStarted":"2016-12-22T18:13:57+0200","dateFinished":"2016-12-22T18:15:16+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"title":"Calc ROC for Test-Set","text":"val host = z.input(\"Host\", \"whyaron\")\nval diyPort = z.input(\"DIY Port\", \"9000\")\nval esPort = z.input(\"ES Port\", \"9200\")\n\nval project1 = z.input(\"Project - 1\")\nval topic1 = z.input(\"Topic - 1\")\nval testset1 = z.input(\"Test set - 1\")\n\nval project2 = z.input(\"Project - 2\")\nval topic2 = z.input(\"Topic - 2\")\nval testset2 = z.input(\"Test set - 2\")\n\n\nval server = host + \":\" + diyPort\nval elastic = host + \":\" + esPort\n\n\nval data = List(ConfData(project1.toString, topic1.toString, testset1.toString), ConfData(project2.toString, topic2.toString, testset2.toString))\n// calculate the estimator values\ncalcRocForConf(data)","dateUpdated":"2016-12-22T18:16:18+0200","config":{"colWidth":6,"graph":{"mode":"lineChart","height":300,"optionOpen":true,"keys":[{"name":"fp1","index":2,"aggr":"sum","$$hashKey":"object:541"},{"name":"fp2","index":4,"aggr":"sum","$$hashKey":"object:542"}],"values":[{"name":"tp1","index":1,"aggr":"avg","$$hashKey":"object:553"},{"name":"tp2","index":3,"aggr":"avg","$$hashKey":"object:554"}],"groups":[],"scatter":{"xAxis":{"name":"threshold","index":0,"aggr":"sum"},"yAxis":{"name":"tp1","index":1,"aggr":"sum"}}},"enabled":true,"editorHide":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{"Host":"whyaron","DIY Port":"9000","ES Port":"9200","Project - 1":"6_topics_nd_1","Topic - 1":"CHAIR1","Test set - 1":"CHAIR1","Project - 2":"6_topics_nd_2","Topic - 2":"CHAIR1","Test set - 2":"CHAIR1"},"forms":{"Host":{"name":"Host","displayName":"Host","type":"input","defaultValue":"whyaron","hidden":false},"DIY Port":{"name":"DIY Port","displayName":"DIY Port","type":"input","defaultValue":"9000","hidden":false},"ES Port":{"name":"ES Port","displayName":"ES Port","type":"input","defaultValue":"9200","hidden":false},"Project - 1":{"name":"Project - 1","displayName":"Project - 1","type":"input","defaultValue":"","hidden":false},"Topic - 1":{"name":"Topic - 1","displayName":"Topic - 1","type":"input","defaultValue":"","hidden":false},"Test set - 1":{"name":"Test set - 1","displayName":"Test set - 1","type":"input","defaultValue":"","hidden":false},"Project - 2":{"name":"Project - 2","displayName":"Project - 2","type":"input","defaultValue":"","hidden":false},"Topic - 2":{"name":"Topic - 2","displayName":"Topic - 2","type":"input","defaultValue":"","hidden":false},"Test set - 2":{"name":"Test set - 2","displayName":"Test set - 2","type":"input","defaultValue":"","hidden":false}}},"jobName":"paragraph_1482414692781_1432647488","id":"20161222-155132_2008990101","result":{"code":"SUCCESS","type":"TABLE","msg":"threshold\ttp1\tfp1\ttp2\tfp2\n0\t172\t127\t172\t127\n5\t161\t96\t172\t127\n10\t158\t89\t167\t123\n15\t158\t89\t167\t123\n20\t157\t82\t167\t123\n25\t157\t82\t167\t123\n30\t156\t79\t167\t123\n35\t156\t79\t167\t123\n40\t156\t79\t167\t123\n45\t154\t65\t167\t123\n49\t154\t65\t167\t123\n54\t154\t65\t167\t123\n59\t154\t65\t167\t123\n64\t154\t65\t167\t123\n69\t154\t65\t167\t123\n75\t144\t48\t167\t123\n80\t135\t39\t165\t107\n85\t135\t35\t165\t107\n90\t135\t35\t165\t107\n95\t135\t35\t165\t107\n100\t134\t35\t165\t107\n105\t134\t35\t165\t107\n110\t134\t35\t165\t107\n115\t134\t34\t165\t107\n120\t134\t34\t165\t107\n125\t134\t34\t165\t107\n130\t134\t34\t165\t107\n135\t134\t34\t165\t107\n140\t133\t34\t165\t107\n145\t128\t27\t165\t107\n150\t128\t27\t165\t107\n155\t128\t27\t165\t107\n160\t128\t27\t165\t107\n165\t128\t27\t165\t107\n170\t128\t27\t165\t107\n175\t128\t27\t165\t107\n180\t128\t26\t165\t107\n185\t128\t26\t165\t107\n190\t128\t26\t162\t102\n195\t128\t26\t162\t102\n200\t128\t25\t162\t102\n205\t128\t25\t162\t102\n210\t128\t25\t162\t102\n215\t127\t25\t162\t102\n220\t127\t25\t151\t77\n225\t127\t25\t151\t77\n230\t127\t25\t151\t77\n235\t127\t25\t151\t77\n240\t127\t25\t151\t77\n245\t127\t25\t151\t77\n250\t127\t25\t151\t77\n255\t127\t25\t151\t77\n260\t127\t25\t151\t77\n265\t127\t25\t151\t77\n270\t127\t25\t151\t77\n275\t108\t11\t151\t77\n280\t108\t11\t151\t77\n285\t108\t11\t151\t77\n290\t108\t11\t151\t77\n295\t108\t11\t151\t77\n300\t108\t11\t151\t77\n305\t108\t11\t151\t77\n310\t108\t11\t151\t77\n315\t108\t11\t151\t77\n320\t108\t11\t151\t77\n325\t108\t11\t151\t77\n330\t108\t11\t151\t77\n335\t108\t11\t151\t77\n340\t108\t11\t151\t77\n345\t108\t11\t151\t77\n350\t108\t11\t151\t77\n355\t108\t11\t151\t77\n360\t108\t11\t151\t77\n365\t108\t11\t151\t77\n370\t108\t11\t151\t77\n375\t108\t11\t151\t77\n380\t108\t11\t151\t77\n385\t108\t11\t151\t77\n390\t108\t11\t151\t77\n395\t108\t11\t151\t77\n400\t108\t11\t150\t75\n405\t108\t11\t150\t75\n410\t108\t11\t150\t75\n415\t108\t11\t150\t75\n420\t108\t11\t150\t75\n425\t108\t11\t150\t75\n430\t108\t11\t150\t75\n435\t108\t11\t150\t75\n440\t108\t11\t150\t75\n445\t108\t11\t150\t75\n450\t108\t11\t150\t75\n455\t108\t11\t150\t75\n460\t108\t11\t150\t75\n465\t108\t11\t150\t75\n470\t89\t7\t142\t67\n475\t89\t7\t142\t67\n480\t89\t7\t142\t67\n485\t89\t7\t142\t67\n490\t89\t7\t142\t67\n495\t89\t7\t141\t67\n500\t89\t7\t141\t67\n505\t89\t7\t141\t66\n510\t89\t7\t141\t66\n515\t89\t7\t141\t66\n520\t89\t7\t141\t66\n525\t89\t7\t141\t66\n530\t89\t7\t141\t66\n535\t89\t7\t141\t66\n540\t89\t7\t141\t66\n545\t89\t7\t141\t66\n550\t89\t7\t141\t66\n555\t89\t7\t121\t48\n560\t88\t7\t121\t48\n565\t45\t1\t121\t48\n570\t45\t1\t121\t48\n575\t45\t1\t121\t48\n580\t45\t1\t121\t48\n585\t44\t1\t121\t48\n590\t44\t1\t121\t48\n595\t44\t1\t121\t48\n600\t44\t1\t121\t48\n605\t44\t1\t121\t48\n610\t44\t1\t121\t48\n615\t44\t1\t121\t48\n620\t44\t1\t121\t48\n625\t44\t1\t121\t48\n630\t44\t1\t121\t48\n635\t44\t1\t121\t48\n640\t44\t1\t121\t48\n645\t44\t1\t121\t48\n650\t44\t1\t121\t48\n655\t44\t1\t121\t48\n660\t44\t1\t121\t48\n665\t44\t1\t121\t48\n670\t44\t1\t115\t46\n675\t44\t1\t115\t46\n680\t43\t1\t115\t46\n685\t43\t1\t115\t46\n690\t43\t1\t115\t46\n695\t43\t1\t115\t46\n700\t40\t1\t115\t46\n705\t40\t1\t115\t46\n710\t40\t1\t115\t46\n715\t40\t1\t115\t45\n720\t40\t1\t115\t45\n725\t40\t1\t115\t45\n730\t40\t1\t115\t45\n735\t40\t1\t115\t45\n740\t40\t1\t115\t45\n745\t8\t0\t115\t45\n750\t8\t0\t110\t38\n755\t8\t0\t110\t38\n760\t8\t0\t110\t38\n765\t8\t0\t110\t38\n770\t8\t0\t110\t38\n775\t8\t0\t110\t38\n780\t8\t0\t110\t38\n785\t8\t0\t110\t38\n790\t8\t0\t110\t38\n795\t8\t0\t110\t38\n800\t8\t0\t110\t38\n805\t8\t0\t110\t38\n810\t8\t0\t110\t38\n815\t8\t0\t110\t38\n820\t8\t0\t110\t38\n825\t8\t0\t43\t7\n830\t8\t0\t43\t7\n835\t8\t0\t43\t7\n840\t8\t0\t43\t7\n845\t8\t0\t43\t7\n850\t8\t0\t43\t7\n855\t8\t0\t43\t7\n860\t8\t0\t43\t7\n865\t8\t0\t43\t7\n870\t8\t0\t43\t7\n875\t8\t0\t43\t7\n880\t8\t0\t43\t7\n885\t8\t0\t43\t7\n890\t8\t0\t43\t7\n895\t8\t0\t43\t7\n900\t8\t0\t43\t7\n905\t8\t0\t0\t0\n910\t8\t0\t0\t0\n915\t0\t0\t0\t0\n920\t0\t0\t0\t0\n925\t0\t0\t0\t0\n930\t0\t0\t0\t0\n935\t0\t0\t0\t0\n940\t0\t0\t0\t0\n945\t0\t0\t0\t0\n950\t0\t0\t0\t0\n955\t0\t0\t0\t0\n960\t0\t0\t0\t0\n965\t0\t0\t0\t0\n970\t0\t0\t0\t0\n975\t0\t0\t0\t0\n980\t0\t0\t0\t0\n985\t0\t0\t0\t0\n990\t0\t0\t0\t0\n995\t0\t0\t0\t0\n1000\t0\t0\t0\t0\n","comment":"","msgTable":[[{"key":"tp1","value":"0"},{"key":"tp1","value":"172"},{"key":"tp1","value":"127"},{"key":"tp1","value":"172"},{"key":"tp1","value":"127"}],[{"key":"fp1","value":"5"},{"key":"fp1","value":"161"},{"key":"fp1","value":"96"},{"key":"fp1","value":"172"},{"key":"fp1","value":"127"}],[{"key":"tp2","value":"10"},{"key":"tp2","value":"158"},{"key":"tp2","value":"89"},{"key":"tp2","value":"167"},{"key":"tp2","value":"123"}],[{"key":"fp2","value":"15"},{"key":"fp2","value":"158"},{"key":"fp2","value":"89"},{"key":"fp2","value":"167"},{"key":"fp2","value":"123"}],[{"value":"20"},{"value":"157"},{"value":"82"},{"value":"167"},{"value":"123"}],[{"value":"25"},{"value":"157"},{"value":"82"},{"value":"167"},{"value":"123"}],[{"value":"30"},{"value":"156"},{"value":"79"},{"value":"167"},{"value":"123"}],[{"value":"35"},{"value":"156"},{"value":"79"},{"value":"167"},{"value":"123"}],[{"value":"40"},{"value":"156"},{"value":"79"},{"value":"167"},{"value":"123"}],[{"value":"45"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"49"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"54"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"59"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"64"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"69"},{"value":"154"},{"value":"65"},{"value":"167"},{"value":"123"}],[{"value":"75"},{"value":"144"},{"value":"48"},{"value":"167"},{"value":"123"}],[{"value":"80"},{"value":"135"},{"value":"39"},{"value":"165"},{"value":"107"}],[{"value":"85"},{"value":"135"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"90"},{"value":"135"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"95"},{"value":"135"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"100"},{"value":"134"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"105"},{"value":"134"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"110"},{"value":"134"},{"value":"35"},{"value":"165"},{"value":"107"}],[{"value":"115"},{"value":"134"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"120"},{"value":"134"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"125"},{"value":"134"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"130"},{"value":"134"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"135"},{"value":"134"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"140"},{"value":"133"},{"value":"34"},{"value":"165"},{"value":"107"}],[{"value":"145"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"150"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"155"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"160"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"165"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"170"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"175"},{"value":"128"},{"value":"27"},{"value":"165"},{"value":"107"}],[{"value":"180"},{"value":"128"},{"value":"26"},{"value":"165"},{"value":"107"}],[{"value":"185"},{"value":"128"},{"value":"26"},{"value":"165"},{"value":"107"}],[{"value":"190"},{"value":"128"},{"value":"26"},{"value":"162"},{"value":"102"}],[{"value":"195"},{"value":"128"},{"value":"26"},{"value":"162"},{"value":"102"}],[{"value":"200"},{"value":"128"},{"value":"25"},{"value":"162"},{"value":"102"}],[{"value":"205"},{"value":"128"},{"value":"25"},{"value":"162"},{"value":"102"}],[{"value":"210"},{"value":"128"},{"value":"25"},{"value":"162"},{"value":"102"}],[{"value":"215"},{"value":"127"},{"value":"25"},{"value":"162"},{"value":"102"}],[{"value":"220"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"225"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"230"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"235"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"240"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"245"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"250"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"255"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"260"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"265"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"270"},{"value":"127"},{"value":"25"},{"value":"151"},{"value":"77"}],[{"value":"275"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"280"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"285"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"290"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"295"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"300"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"305"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"310"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"315"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"320"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"325"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"330"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"335"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"340"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"345"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"350"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"355"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"360"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"365"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"370"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"375"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"380"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"385"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"390"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"395"},{"value":"108"},{"value":"11"},{"value":"151"},{"value":"77"}],[{"value":"400"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"405"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"410"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"415"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"420"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"425"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"430"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"435"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"440"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"445"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"450"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"455"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"460"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"465"},{"value":"108"},{"value":"11"},{"value":"150"},{"value":"75"}],[{"value":"470"},{"value":"89"},{"value":"7"},{"value":"142"},{"value":"67"}],[{"value":"475"},{"value":"89"},{"value":"7"},{"value":"142"},{"value":"67"}],[{"value":"480"},{"value":"89"},{"value":"7"},{"value":"142"},{"value":"67"}],[{"value":"485"},{"value":"89"},{"value":"7"},{"value":"142"},{"value":"67"}],[{"value":"490"},{"value":"89"},{"value":"7"},{"value":"142"},{"value":"67"}],[{"value":"495"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"67"}],[{"value":"500"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"67"}],[{"value":"505"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"510"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"515"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"520"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"525"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"530"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"535"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"540"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"545"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"550"},{"value":"89"},{"value":"7"},{"value":"141"},{"value":"66"}],[{"value":"555"},{"value":"89"},{"value":"7"},{"value":"121"},{"value":"48"}],[{"value":"560"},{"value":"88"},{"value":"7"},{"value":"121"},{"value":"48"}],[{"value":"565"},{"value":"45"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"570"},{"value":"45"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"575"},{"value":"45"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"580"},{"value":"45"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"585"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"590"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"595"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"600"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"605"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"610"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"615"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"620"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"625"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"630"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"635"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"640"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"645"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"650"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"655"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"660"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"665"},{"value":"44"},{"value":"1"},{"value":"121"},{"value":"48"}],[{"value":"670"},{"value":"44"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"675"},{"value":"44"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"680"},{"value":"43"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"685"},{"value":"43"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"690"},{"value":"43"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"695"},{"value":"43"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"700"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"705"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"710"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"46"}],[{"value":"715"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"720"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"725"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"730"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"735"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"740"},{"value":"40"},{"value":"1"},{"value":"115"},{"value":"45"}],[{"value":"745"},{"value":"8"},{"value":"0"},{"value":"115"},{"value":"45"}],[{"value":"750"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"755"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"760"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"765"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"770"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"775"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"780"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"785"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"790"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"795"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"800"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"805"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"810"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"815"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"820"},{"value":"8"},{"value":"0"},{"value":"110"},{"value":"38"}],[{"value":"825"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"830"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"835"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"840"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"845"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"850"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"855"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"860"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"865"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"870"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"875"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"880"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"885"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"890"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"895"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"900"},{"value":"8"},{"value":"0"},{"value":"43"},{"value":"7"}],[{"value":"905"},{"value":"8"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"910"},{"value":"8"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"915"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"920"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"925"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"930"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"935"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"940"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"945"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"950"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"955"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"960"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"965"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"970"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"975"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"980"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"985"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"990"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"995"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}],[{"value":"1000"},{"value":"0"},{"value":"0"},{"value":"0"},{"value":"0"}]],"columnNames":[{"name":"threshold","index":0,"aggr":"sum","$$hashKey":"object:514"},{"name":"tp1","index":1,"aggr":"sum","$$hashKey":"object:515"},{"name":"fp1","index":2,"aggr":"sum","$$hashKey":"object:516"},{"name":"tp2","index":3,"aggr":"sum","$$hashKey":"object:517"},{"name":"fp2","index":4,"aggr":"sum","$$hashKey":"object:518"}],"rows":[["0","172","127","172","127"],["5","161","96","172","127"],["10","158","89","167","123"],["15","158","89","167","123"],["20","157","82","167","123"],["25","157","82","167","123"],["30","156","79","167","123"],["35","156","79","167","123"],["40","156","79","167","123"],["45","154","65","167","123"],["49","154","65","167","123"],["54","154","65","167","123"],["59","154","65","167","123"],["64","154","65","167","123"],["69","154","65","167","123"],["75","144","48","167","123"],["80","135","39","165","107"],["85","135","35","165","107"],["90","135","35","165","107"],["95","135","35","165","107"],["100","134","35","165","107"],["105","134","35","165","107"],["110","134","35","165","107"],["115","134","34","165","107"],["120","134","34","165","107"],["125","134","34","165","107"],["130","134","34","165","107"],["135","134","34","165","107"],["140","133","34","165","107"],["145","128","27","165","107"],["150","128","27","165","107"],["155","128","27","165","107"],["160","128","27","165","107"],["165","128","27","165","107"],["170","128","27","165","107"],["175","128","27","165","107"],["180","128","26","165","107"],["185","128","26","165","107"],["190","128","26","162","102"],["195","128","26","162","102"],["200","128","25","162","102"],["205","128","25","162","102"],["210","128","25","162","102"],["215","127","25","162","102"],["220","127","25","151","77"],["225","127","25","151","77"],["230","127","25","151","77"],["235","127","25","151","77"],["240","127","25","151","77"],["245","127","25","151","77"],["250","127","25","151","77"],["255","127","25","151","77"],["260","127","25","151","77"],["265","127","25","151","77"],["270","127","25","151","77"],["275","108","11","151","77"],["280","108","11","151","77"],["285","108","11","151","77"],["290","108","11","151","77"],["295","108","11","151","77"],["300","108","11","151","77"],["305","108","11","151","77"],["310","108","11","151","77"],["315","108","11","151","77"],["320","108","11","151","77"],["325","108","11","151","77"],["330","108","11","151","77"],["335","108","11","151","77"],["340","108","11","151","77"],["345","108","11","151","77"],["350","108","11","151","77"],["355","108","11","151","77"],["360","108","11","151","77"],["365","108","11","151","77"],["370","108","11","151","77"],["375","108","11","151","77"],["380","108","11","151","77"],["385","108","11","151","77"],["390","108","11","151","77"],["395","108","11","151","77"],["400","108","11","150","75"],["405","108","11","150","75"],["410","108","11","150","75"],["415","108","11","150","75"],["420","108","11","150","75"],["425","108","11","150","75"],["430","108","11","150","75"],["435","108","11","150","75"],["440","108","11","150","75"],["445","108","11","150","75"],["450","108","11","150","75"],["455","108","11","150","75"],["460","108","11","150","75"],["465","108","11","150","75"],["470","89","7","142","67"],["475","89","7","142","67"],["480","89","7","142","67"],["485","89","7","142","67"],["490","89","7","142","67"],["495","89","7","141","67"],["500","89","7","141","67"],["505","89","7","141","66"],["510","89","7","141","66"],["515","89","7","141","66"],["520","89","7","141","66"],["525","89","7","141","66"],["530","89","7","141","66"],["535","89","7","141","66"],["540","89","7","141","66"],["545","89","7","141","66"],["550","89","7","141","66"],["555","89","7","121","48"],["560","88","7","121","48"],["565","45","1","121","48"],["570","45","1","121","48"],["575","45","1","121","48"],["580","45","1","121","48"],["585","44","1","121","48"],["590","44","1","121","48"],["595","44","1","121","48"],["600","44","1","121","48"],["605","44","1","121","48"],["610","44","1","121","48"],["615","44","1","121","48"],["620","44","1","121","48"],["625","44","1","121","48"],["630","44","1","121","48"],["635","44","1","121","48"],["640","44","1","121","48"],["645","44","1","121","48"],["650","44","1","121","48"],["655","44","1","121","48"],["660","44","1","121","48"],["665","44","1","121","48"],["670","44","1","115","46"],["675","44","1","115","46"],["680","43","1","115","46"],["685","43","1","115","46"],["690","43","1","115","46"],["695","43","1","115","46"],["700","40","1","115","46"],["705","40","1","115","46"],["710","40","1","115","46"],["715","40","1","115","45"],["720","40","1","115","45"],["725","40","1","115","45"],["730","40","1","115","45"],["735","40","1","115","45"],["740","40","1","115","45"],["745","8","0","115","45"],["750","8","0","110","38"],["755","8","0","110","38"],["760","8","0","110","38"],["765","8","0","110","38"],["770","8","0","110","38"],["775","8","0","110","38"],["780","8","0","110","38"],["785","8","0","110","38"],["790","8","0","110","38"],["795","8","0","110","38"],["800","8","0","110","38"],["805","8","0","110","38"],["810","8","0","110","38"],["815","8","0","110","38"],["820","8","0","110","38"],["825","8","0","43","7"],["830","8","0","43","7"],["835","8","0","43","7"],["840","8","0","43","7"],["845","8","0","43","7"],["850","8","0","43","7"],["855","8","0","43","7"],["860","8","0","43","7"],["865","8","0","43","7"],["870","8","0","43","7"],["875","8","0","43","7"],["880","8","0","43","7"],["885","8","0","43","7"],["890","8","0","43","7"],["895","8","0","43","7"],["900","8","0","43","7"],["905","8","0","0","0"],["910","8","0","0","0"],["915","0","0","0","0"],["920","0","0","0","0"],["925","0","0","0","0"],["930","0","0","0","0"],["935","0","0","0","0"],["940","0","0","0","0"],["945","0","0","0","0"],["950","0","0","0","0"],["955","0","0","0","0"],["960","0","0","0","0"],["965","0","0","0","0"],["970","0","0","0","0"],["975","0","0","0","0"],["980","0","0","0","0"],["985","0","0","0","0"],["990","0","0","0","0"],["995","0","0","0","0"],["1000","0","0","0","0"]]},"dateCreated":"2016-12-22T03:51:32+0200","dateStarted":"2016-12-22T18:10:49+0200","dateFinished":"2016-12-22T18:12:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"title":"","text":"import scala.io.Source\nimport scala.util.parsing.json._\nimport org.apache.spark.SparkContext\nimport org.apache.spark.sql.Row\nimport sqlContext.implicits._\n\ncase class RecallItem(threshold: Int, recall: Double)\n\ncase class CountItem(threshold: Int, count: Long)\n\ncase class DataItem(threshold: Int, recall: Double, count: Long)\n\ncase class ThinDoc(id: String, score: Double, isTriaged: Boolean)\n\ncase class ConfData(project: String, topic: String, testset: String)\n\ncase class RocData(threshold: Int, tp: Long, fp: Long)\n\n\ndef toDouble: (Any) => Double = { case i: Int => i case l: Long => l case f: Float => f case d: Double => d }\n\ndef getThresholdRecallMap(project: String, topic: String, testset: String): List[RecallItem] = {\n    \n    val diyThresholdApi = \"http://\" + server + \"/api/categorization/threshold/fnr/\" + project + \"?label=\" + topic + \"&testSetId=\" + testset\n\n    val html = Source.fromURL(diyThresholdApi)\n   \n    val s = html.mkString\n    \n    val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n     \n    val data = sc.parallelize(s :: Nil)\n    \n    val df = sqlContext.read.json(data).select(explode($\"thresholdsSpectrumStats\").as(\"thresholds_flat\"))\n    \n    val items = df.select(\"thresholds_flat.threshold\", \"thresholds_flat.recall\")\n    .map(row => RecallItem(((toDouble(row(0)))*1000).toInt, toDouble(row(1))))\n    .collect()\n    \n    items.toList\n}\n\n\ndef getAllDocs(project: String, topic: String, testset: String): List[ThinDoc] = {\n    \n    val url = \"http://\" + elastic + \"/fnr-\" + project + \"-test-\" + testset.toString.toLowerCase() + \"/instance/_search?size=10000\"\n    \n    val html = Source.fromURL(url)\n   \n    val s = html.mkString\n    \n    val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n     \n    val data = sc.parallelize(s :: Nil)\n    \n    val df = sqlContext.read.json(data).select(explode($\"hits.hits._source\").as(\"docs\"))\n    \n    val items = df.select(\"docs.textId\", \"docs.score\", \"docs.isTriaged\")\n    .map(row => ThinDoc(row(0).asInstanceOf[String], row(1).asInstanceOf[Double], row(2).asInstanceOf[Boolean]))\n    .collect()\n    \n    items.toList\n    \n}\n\n\ndef getUnlabledPassedThrehold(project: String, topic: String, testset: String): List[CountItem] = {\n    \n    var items: List[CountItem] = List[CountItem]()\n    \n    val thresholdStep: Double = 0.005\n \n    val allDocs: List[ThinDoc] = getAllDocs(project, topic, testset)\n\n    var currentThresholdStep: Double = 0.0\n\n    do {\n\n      val count = allDocs.filter(doc => doc.score >= currentThresholdStep).size\n      \n      items = CountItem((currentThresholdStep*1000).toInt, count) :: items \n\n      currentThresholdStep += thresholdStep\n\n      currentThresholdStep = (Math.round((currentThresholdStep) * 1000)) / 1000.0\n\n    } while(currentThresholdStep < 1)   \n    \n    items\n}\n\ndef calcEstimatorForConf(list: List[ConfData]): Unit = {\n    \n    val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n    \n    var results: List[Array[DataItem]] = List[Array[DataItem]]()\n    \n    list.foreach(conf => {\n        \n        if(conf.project != \"\" && conf.topic != \"\" && conf.testset != \"\") {\n        \n            // get all thresolds values\n            val df1 = getThresholdRecallMap(conf.project, conf.topic, conf.testset).toDF\n            \n            // get the unlabled map\n            val df2 = getUnlabledPassedThrehold(conf.project, conf.topic, conf.testset).toDF\n            \n            df1.createOrReplaceTempView(\"df1\")\n          \n            df2.createOrReplaceTempView(\"df2\")\n            \n            val result = (sqlContext.sql(\"SELECT u.threshold, u.count, d.recall from df1 d JOIN df2 u WHERE u.threshold = d.threshold\").map {\n        \n                case Row(threshold: Int, count: Long, recall: Double) => {\n                \n                \tDataItem(threshold, recall, count)\n                \n                }\n        \n            }.collect())\n        \n            results = result :: results\n    \n        }\n    })\n\n    \n    val reducedDF = results.map(items => {\n        sc.parallelize(items).toDF()\n    })\n    .reduceLeft((df1, df2) => {\n        df1.join(df2, \"threshold\")\n    })\n    .sort($\"threshold\")\n    .map(row => {\n        (toDouble(row(0)))/1000.0 +\"\\t\" + (toDouble(row(1)))*100 +\"\\t\" + row(2) +\"\\t\" + (toDouble(row(3)))*100 +\"\\t\" +row(4)\n    })\n    .collect()\n\n    println(\"%table threshold\\trecall1\\tcount1\\trecall2\\tcount2\\n\" + reducedDF.mkString(\"\\n\"))\n\n}\n\ndef getRocData(project: String, topic: String, testset: String): List[RocData] = {\n    \n    val diyThresholdApi = \"http://\" + server + \"/api/categorization/threshold/fnr/\" + project + \"?label=\" + topic + \"&testSetId=\" + testset\n\n    val html = Source.fromURL(diyThresholdApi)\n   \n    val s = html.mkString\n    \n    val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n     \n    val data = sc.parallelize(s :: Nil)\n    \n    val df = sqlContext.read.json(data).select(explode($\"thresholdsSpectrumStats\").as(\"thresholds_flat\"))\n    \n    val items = df.select(\"thresholds_flat.threshold\", \"thresholds_flat.tp\", \"thresholds_flat.fp\")\n    .map(row => RocData(((row(0).asInstanceOf[Double])*1000).toInt, row(1).asInstanceOf[Long], row(2).asInstanceOf[Long]))\n    .collect()\n    \n    items.toList\n}\n\ndef calcRocForConf(list: List[ConfData]): Unit = {\n    \n    val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n    \n    var results: List[Array[RocData]] = List[Array[RocData]]()\n    \n    list.foreach(conf => {\n        \n        if(conf.project != \"\" && conf.topic != \"\" && conf.testset != \"\") {\n        \n            // get ROC data for testset\n            val df = getRocData(conf.project, conf.topic, conf.testset).toDF\n            \n            df.createOrReplaceTempView(\"df\")\n            \n            val result = (sqlContext.sql(\"SELECT threshold, tp, fp from df\").map {\n        \n                case Row(threshold: Int, tp: Long, fp: Long) => {\n                \n                \tRocData(threshold, tp, fp)\n                \n                }\n        \n            }.collect())\n        \n            results = result :: results\n           \n        }\n    })\n\n    \n    val reducedDF = results.map(items => {\n        sc.parallelize(items).toDF()\n    })\n    .reduceLeft((df1, df2) => {\n        df1.join(df2, \"threshold\")\n    })\n    .sort($\"threshold\")\n    .map(row => {\n        \"\" + row(0) + \"\\t\" + row(1) + \"\\t\" + row(2) + \"\\t\" + row(3) + \"\\t\" + row(4)\n    })\n   \n    .collect()\n\n    println(\"%table threshold\\ttp1\\tfp1\\ttp2\\tfp2\\n\" + reducedDF.mkString(\"\\n\"))\n\n}\n\n\n","dateUpdated":"2016-12-22T18:09:47+0200","config":{"colWidth":12,"enabled":true,"editorMode":"ace/mode/scala","lineNumbers":true,"tableHide":false,"editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481838243440_1182889908","id":"20161215-234403_1930059412","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport scala.io.Source\n\nimport scala.util.parsing.json._\n\nimport org.apache.spark.SparkContext\n\nimport org.apache.spark.sql.Row\n\nimport sqlContext.implicits._\n\ndefined class RecallItem\n\ndefined class CountItem\n\ndefined class DataItem\n\ndefined class ThinDoc\n\ndefined class ConfData\n\ndefined class RocData\n\ntoDouble: Any => Double\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ngetThresholdRecallMap: (project: String, topic: String, testset: String)List[RecallItem]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ngetAllDocs: (project: String, topic: String, testset: String)List[ThinDoc]\n\ngetUnlabledPassedThrehold: (project: String, topic: String, testset: String)List[CountItem]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ncalcEstimatorForConf: (list: List[ConfData])Unit\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ngetRocData: (project: String, topic: String, testset: String)List[RocData]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ncalcRocForConf: (list: List[ConfData])Unit\n"},"dateCreated":"2016-12-15T11:44:03+0200","dateStarted":"2016-12-22T18:09:48+0200","dateFinished":"2016-12-22T18:10:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"text":"","dateUpdated":"2016-12-22T16:47:52+0200","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482418062126_2100117605","id":"20161222-164742_513670115","dateCreated":"2016-12-22T16:47:42+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:291"}],"name":"Notebooks/quality","id":"2C6RWDZY4","angularObjects":{"2C61RHS36:shared_process":[],"2C3U8C4QA:shared_process":[],"2C36YNQ5D:shared_process":[],"2C4UZ2Y1S:shared_process":[],"2C4WG3VKH:shared_process":[],"2C4PQ2C2U:shared_process":[],"2C4ACE37D:shared_process":[],"2C2DGSP1R:shared_process":[],"2C659DVVS:shared_process":[],"2C4BCSMCJ:shared_process":[],"2C44HURTJ:shared_process":[],"2C5EZPGYM:shared_process":[],"2C5GSWD9G:shared_process":[],"2C2RSBXRV:shared_process":[],"2C5UTHNAR:shared_process":[],"2C654FFBK:shared_process":[],"2C3A51V4T:shared_process":[],"2C4V7JJ25:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}